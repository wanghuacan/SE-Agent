# SE Framework - SWE-agent å¤šæ ·æ€§å®éªŒæ¡†æ¶

## æ¦‚è¿°

SEæ¡†æ¶æ˜¯åŸºäºSWE-agentçš„è½»é‡çº§æ‰©å±•ï¼Œä¸“æ³¨äºå¯¹åŒä¸€é—®é¢˜æ‰§è¡Œå¤šæ¬¡ä¸åŒçš„è§£å†³å°è¯•ï¼Œé€šè¿‡ç­–ç•¥ç¼–æ’å’Œç®—å­ç³»ç»Ÿå®ç°è§£å†³æ–¹æ¡ˆçš„å¤šæ ·æ€§ã€‚

> **æ³¨æ„**: æœ¬æ–‡æ¡£ä¸“é—¨ä»‹ç» SE æ¡†æ¶çš„è¯¦ç»†è®¾è®¡å’Œä½¿ç”¨ã€‚å¦‚éœ€äº†è§£æ•´ä¸ªé¡¹ç›®æ¶æ„å’Œå…¶ä»–æ¡†æ¶ï¼ˆAtlasç­‰ï¼‰ï¼Œè¯·å‚è€ƒæ ¹ç›®å½•çš„ [CLAUDE.md](/CLAUDE.md)ã€‚

## ğŸš€ å¿«é€Ÿå…¥é—¨

### ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Ÿä»è¿™é‡Œå¼€å§‹ï¼

#### 1ï¸âƒ£ è¿è¡Œäº¤äº’å¼æ¼”ç¤º (æ¨è)
```bash
# å¿«é€Ÿä½“éªŒ (5åˆ†é’Ÿ)
python SE/demo_data_flow.py --mode quick

# è¯¦ç»†äº†è§£ (15åˆ†é’Ÿ) 
python SE/demo_data_flow.py --mode detailed

# å¼€å‘è€…æ¨¡å¼ (30åˆ†é’Ÿ)
python SE/demo_data_flow.py --mode developer
```

#### 2ï¸âƒ£ è¿è¡Œæµ‹è¯•å¥—ä»¶
```bash
# éªŒè¯ç³»ç»Ÿå®Œæ•´æ€§
python SE/test/run_operator_tests.py

# æµ‹è¯•ç‰¹å®šç®—å­
python SE/test/test_alternative_strategy.py
```

#### 3ï¸âƒ£ é˜…è¯»å­¦ä¹ æŒ‡å—
```bash
ğŸ“š SE/LEARNING_GUIDE.md    # å®Œæ•´å­¦ä¹ è·¯å¾„
ğŸ“– æœ¬æ–‡æ¡£ä¸‹æ–¹çš„ "ğŸ“Š æ ¸å¿ƒæ•°æ®æ ¼å¼è§„èŒƒ" éƒ¨åˆ†
```

#### 4ï¸âƒ£ è¿è¡Œå®é™…å®éªŒ
```bash
# æ¼”ç¤ºæ¨¡å¼ï¼ˆä¸æ‰§è¡ŒçœŸå®SWE-agentï¼‰
python SE/basic_run.py --mode demo

# æ‰§è¡Œæ¨¡å¼ï¼ˆéœ€è¦é…ç½®API keyï¼‰
python SE/basic_run.py --mode execute --config SE/configs/se_configs/test_deepseek_se.yaml
```

## æ ¸å¿ƒè®¾è®¡ç†å¿µ

### ğŸ¯ ç›®æ ‡
å¯¹æ¯ä¸ªé—®é¢˜è¿›è¡Œå¤šæ¬¡è¿­ä»£ï¼Œç¡®ä¿æ¯æ¬¡éƒ½äº§ç”ŸçœŸæ­£ä¸åŒçš„è§£å†³è·¯å¾„å’Œç­–ç•¥ã€‚

### ğŸ—ï¸ æ¶æ„å±‚æ¬¡
```
SE_Runner (å¤–å±‚ç»Ÿä¸€ç®¡ç†å™¨)
    â†“ ç®¡ç†å…¨å±€é…ç½® (output_dir, model, apiç­‰)  
    â†“ æ‰§è¡Œç­–ç•¥ç¼–æ’ (ç¬¬1æ¬¡ã€ç¬¬2æ¬¡ã€ç¬¬3æ¬¡...)
    â†“ 
    â†“ å¾ªç¯å¤šæ¬¡è¿­ä»£:
    â†“   â”œâ”€â”€ ç®—å­å¤„ç†å†å²æ•°æ® (å¦‚éœ€è¦)
    â†“   â”œâ”€â”€ ç”Ÿæˆå±€éƒ¨å‚æ•°
    â†“   â””â”€â”€ è°ƒç”¨SWE_Iterator
    â†“
SWE_Iterator (å•æ¬¡è¿è¡Œå™¨)
    â†“ æ¥æ”¶å…¨å±€å‚æ•° + å±€éƒ¨å‚æ•°
    â†“ æ‰§è¡Œå•æ¬¡SWE-agentè¿è¡Œ
    â†“ è¾“å‡ºåˆ° output_dir/instance_name/{è¿­ä»£ç¼–å·}/
```

### ğŸ”„ å‚æ•°ä¼ é€’è®¾è®¡
- **å…¨å±€å‚æ•°**: ç”±SE_Runnerç®¡ç†ï¼Œå›ºå®šä¸å˜ (model, output_dir, apié…ç½®ç­‰)
- **å±€éƒ¨å‚æ•°**: ç”±ç®—å­è¿‡ç¨‹è¾“å‡ºå†³å®š (instance_templates_dir, --enhance-history-filter-json)

## é¡¹ç›®ç»“æ„

```
SE/
â”œâ”€â”€ run.py                          # SEæ¡†æ¶ä¸»å…¥å£ï¼ˆç©ºæ–‡ä»¶ï¼‰
â”œâ”€â”€ basic_run.py                    # å®é™…å¯ç”¨çš„SEåŸºç¡€è¿è¡Œå™¨
â”œâ”€â”€ operator_dev.py                 # ç®—å­å¼€å‘æµ‹è¯•è„šæœ¬
â”œâ”€â”€ configs/                        # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ se_configs/                 # SEä¸»é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ example_experiment.yaml
â”‚   â”‚   â””â”€â”€ test_deepseek_se.yaml
â”‚   â”œâ”€â”€ base_configs/               # SWE-agentåŸºç¡€é…ç½®
â”‚   â”‚   â”œâ”€â”€ baseconfig1.yaml
â”‚   â”‚   â””â”€â”€ baseconfig2.yaml
â”‚   â””â”€â”€ test_config/                # æµ‹è¯•é…ç½®
â”‚       â””â”€â”€ test_claude.yaml
â”œâ”€â”€ core/                           # æ ¸å¿ƒç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py                 # æ ¸å¿ƒæ¨¡å—æ¥å£ï¼ˆç©ºï¼‰
â”‚   â”œâ”€â”€ swe_iterator.py             # SWE-agentç»Ÿä¸€è¿­ä»£è¿è¡Œå™¨
â”‚   â””â”€â”€ utils/                      # å·¥å…·å‡½æ•°ç›®å½•
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ se_logger.py            # SEæ¡†æ¶æ—¥å¿—ç³»ç»Ÿ
â”‚       â””â”€â”€ organize_folder.py      # å·¥ä½œç›®å½•æ ¼å¼è½¬æ¢å·¥å…·
â”œâ”€â”€ operators/                      # ç®—å­ç³»ç»Ÿ
â”‚   â”œâ”€â”€ __init__.py                 # ç®—å­ç»Ÿä¸€æ¥å£
â”‚   â”œâ”€â”€ base.py                     # ç®—å­åŸºç±»å®šä¹‰
â”‚   â””â”€â”€ registry.py                 # ç®—å­æ³¨å†Œç®¡ç†ç³»ç»Ÿ
â”œâ”€â”€ instances/                      # æµ‹è¯•å®ä¾‹ç›®å½•
â”‚   â”œâ”€â”€ test.json                   # æµ‹è¯•å®ä¾‹é…ç½®
â”‚   â”œâ”€â”€ 1.json, 5.json, 8.json...  # å…·ä½“æµ‹è¯•ç”¨ä¾‹
â”‚   â””â”€â”€ caogao                      # è‰ç¨¿æ–‡ä»¶å¤¹
â”œâ”€â”€ test/                           # æµ‹è¯•æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ api_test.py
â”‚   â”œâ”€â”€ converter_old.py            # æ—§ç‰ˆè½¨è¿¹è½¬æ¢å™¨å‚è€ƒ
â”‚   â””â”€â”€ counter_generation/         # è®¡æ•°å™¨ç”Ÿæˆæµ‹è¯•
â””â”€â”€ trajectories/                   # SEæ¡†æ¶è¿è¡Œæ—¶è¾“å‡ºç›®å½•
    â”œâ”€â”€ Demo_Structure/             # æ ‡å‡†è¾“å‡ºç»“æ„ç¤ºä¾‹
    â”‚   â”œâ”€â”€ iteration_1/            # ç¬¬ä¸€æ¬¡è¿­ä»£ç»“æœ
    â”‚   â”œâ”€â”€ iteration_2/            # ç¬¬äºŒæ¬¡è¿­ä»£ç»“æœ
    â”‚   â””â”€â”€ se_framework.log        # SEæ¡†æ¶æ—¥å¿—
    â””â”€â”€ operator_dev_test/          # ç®—å­å¼€å‘æµ‹è¯•è¾“å‡º
        â””â”€â”€ test_20250714_xxxxx/    # æ—¶é—´æˆ³å‘½åçš„æµ‹è¯•è¿è¡Œ
```

## å‚æ•°ç¼–å†™æŒ‡å—

### å·¥ä½œç›®å½•è§„èŒƒ
- **é¡¹ç›®æ ¹ç›®å½•**: `/home/uaih3k9x/630_swe` 
- **SEæ¡†æ¶ä½ç½®**: `SE/` (ç›¸å¯¹äºæ ¹ç›®å½•)
- **è¿è¡Œæ–¹å¼**: æ‰€æœ‰SEç›¸å…³å‘½ä»¤å¿…é¡»åœ¨æ ¹ç›®å½•æ‰§è¡Œ
- **è·¯å¾„æ ¼å¼**: é…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰è·¯å¾„ç›¸å¯¹äºæ ¹ç›®å½•ç¼–å†™

> **é‡è¦**: SEæ¡†æ¶ä½œä¸ºæ•´ä¸ªé¡¹ç›®çš„ä¸€ä¸ªå­æ¨¡å—ï¼Œä¸¥æ ¼éµå¾ªé¡¹ç›®çº§åˆ«çš„è·¯å¾„å’Œé…ç½®çº¦å®šã€‚

### é…ç½®å‚æ•°æµè½¬
1. **iterator_configå¯¹è±¡**: æ¯æ¬¡è¿­ä»£ä¸­å¯å˜çš„å‚æ•°
   - `base_config`: åŸºç¡€é…ç½®åç§°
   - `special_arguments`: ç®—å­è¾“å‡ºçš„å‚æ•°ï¼ˆjsonæ–‡ä»¶/æ–‡ä»¶å¤¹è·¯å¾„ï¼‰,æŒ‡å®šåˆ°`instance_templates_dir`æˆ–`--enhance-history-filter-json`

2. **è·¯å¾„ç¼–å†™åŸåˆ™**:
   ```yaml
   # æ­£ç¡®ï¼šç›¸å¯¹äºæ ¹ç›®å½•
   json_file: "SE/instances/5.json"
   output_dir: "SE/trajectories/testt_5"
   
   # é”™è¯¯ï¼šç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„æ··æ·†
   json_file: "/home/uaih3k9x/630_swe/SE/instances/5.json"
   output_dir: "./trajectories/testt_5"
   ```

3. **SWE Iteratorè°ƒç”¨æ ¼å¼**:
   ```bash
   # æ ‡å‡†è°ƒç”¨æ ¼å¼
   python SE/core/swe_iterator.py SE/configs/base_configs/test_claude.yaml
   
   # å¸¦å¢å¼ºåŠŸèƒ½çš„è°ƒç”¨
   python SE/core/swe_iterator.py SE/configs/base_configs/test_claude.yaml --enhance-history-filter-json path/to/enhancement.json
   ```

## Utils

### æ—¥å¿—ç³»ç»Ÿ (`se_logger.py`)

- **æ–‡ä»¶è·¯å¾„**: `SE/core/utils/se_logger.py`
- **åŠŸèƒ½**: åŸºäºSWE-agentç°æœ‰æ—¥å¿—ç³»ç»Ÿï¼Œä¸ºSEæ¡†æ¶æä¾›ç»Ÿä¸€çš„æ—¥å¿—ç®¡ç†

#### ä¸»è¦ç‰¹æ€§
1. **æ–‡ä»¶å­˜å‚¨**: æ—¥å¿—ä¿å­˜åœ¨æ¯æ¬¡è¿è¡Œçš„output_dirä¸‹ï¼ˆå¦‚ `SE/trajectories/testt_5/se_framework.log`ï¼‰
2. **å…¨çº§åˆ«è®°å½•**: è®°å½•DEBUGã€INFOã€WARNINGã€ERRORæ‰€æœ‰çº§åˆ«çš„ä¿¡æ¯
3. **æ¨¡å—åŒ–è®¾è®¡**: æ”¯æŒä¸åŒæ¨¡å—ä½¿ç”¨ä¸åŒemojiåŒºåˆ†ï¼ˆâš™ï¸ ğŸ“‹ ğŸ”§ ğŸ¯ ç­‰ï¼‰
4. **çº¿ç¨‹å®‰å…¨**: åŸºäºSWE-agentçš„çº¿ç¨‹å®‰å…¨æ—¥å¿—ç³»ç»Ÿ

#### åŸºæœ¬ä½¿ç”¨
```python
from SE.core.utils.se_logger import setup_se_logging, get_se_logger

# 1. è®¾ç½®æ—¥å¿—ç³»ç»Ÿï¼ˆåœ¨è¿è¡Œå¼€å§‹æ—¶è°ƒç”¨ä¸€æ¬¡ï¼‰
log_file = setup_se_logging("SE/trajectories/testt_5")

# 2. è·å–loggerå®ä¾‹ï¼ˆåœ¨å„ä¸ªæ¨¡å—ä¸­ä½¿ç”¨ï¼‰
logger = get_se_logger("basic_run", emoji="âš™ï¸")

# 3. è®°å½•æ—¥å¿—
logger.info("SEåŸºç¡€è¿è¡Œè„šæœ¬å¯åŠ¨")
logger.debug("è¯¦ç»†è°ƒè¯•ä¿¡æ¯")
logger.warning("è­¦å‘Šä¿¡æ¯")
logger.error("é”™è¯¯ä¿¡æ¯", exc_info=True)  # åŒ…å«å¼‚å¸¸å †æ ˆ
```

#### æ—¥å¿—æ–‡ä»¶æ ¼å¼
```
2025-07-13 10:30:15,123 - INFO - SE.basic_run - SEåŸºç¡€è¿è¡Œè„šæœ¬å¯åŠ¨
2025-07-13 10:30:15,124 - DEBUG - SE.basic_run - ä½¿ç”¨é…ç½®æ–‡ä»¶: SE/configs/se_configs/test_deepseek_se.yaml
2025-07-13 10:30:15,125 - ERROR - SE.basic_run - è¿è¡Œå‡ºé”™: FileNotFoundError
```

### å·¥ä½œç›®å½•è½¬æ¢å·¥å…· (`organize_folder.py`)

- **æ–‡ä»¶è·¯å¾„**: `SE/core/utils/organize_folder.py`
- **åŠŸèƒ½**: å°†å·¥ä½œç›®å½•ä»iteratorï¼ˆSWE-agentï¼‰é£æ ¼è½¬æ¢ä¸ºSEé£æ ¼ï¼Œä»¥æ§åˆ¶è¿­ä»£çš„ç¨³å¥æ€§

#### ä¸»è¦åŠŸèƒ½
1. **ç›®å½•ç»“æ„è½¬æ¢**: å°†`trajectory/instance_id/files`æ ¼å¼è½¬æ¢ä¸º`trajectory/instance_id/1/files`çš„è¿­ä»£è¿è¡Œç»“æ„
2. **è½¨è¿¹æ–‡ä»¶å¤„ç†**: è‡ªåŠ¨å¤„ç†`.traj`æ–‡ä»¶ï¼Œç”Ÿæˆç®€åŒ–çš„`.tra`æ–‡ä»¶ç”¨äºåˆ†æ
3. **å†…å®¹æˆªæ–­ä¼˜åŒ–**: å¯¹é•¿å†…å®¹è¿›è¡Œæ™ºèƒ½æˆªæ–­ï¼Œå‡å°‘å­˜å‚¨ç©ºé—´å’Œæé«˜å¤„ç†æ•ˆç‡
4. **ç»Ÿè®¡ä¿¡æ¯è®°å½•**: ç”Ÿæˆå¤„ç†æ—¥å¿—ï¼Œè®°å½•tokenæ•°é‡å’Œæ–‡ä»¶å¤„ç†ç»Ÿè®¡

#### è®¾è®¡å‚è€ƒ
- åŸºäº`test/converter_old.py`çš„é€»è¾‘è®¾è®¡ï¼ˆä»…ä½œå‚è€ƒï¼Œéœ€æ ¹æ®SEæ¡†æ¶éœ€æ±‚é‡æ–°å®ç°ï¼‰
- æ”¯æŒè¿­ä»£å¼ç»„ç»‡ï¼Œç¡®ä¿å¤šæ¬¡è¿è¡Œä¸å†²çª
- æä¾›è½¨è¿¹æ–‡ä»¶çš„æ ‡å‡†åŒ–å¤„ç†æµç¨‹

#### ä½¿ç”¨åœºæ™¯
- å°†SWE-agentåŸå§‹è¾“å‡ºè½¬æ¢ä¸ºSEæ¡†æ¶å…¼å®¹æ ¼å¼
- æ¸…ç†å’Œä¼˜åŒ–è½¨è¿¹æ–‡ä»¶å­˜å‚¨
- ä¸ºåç»­åˆ†æå’Œå¤„ç†æä¾›æ ‡å‡†åŒ–æ•°æ®ç»“æ„

> **æ³¨æ„**: è¯¥å·¥å…·å½“å‰ä¸ºè§„åˆ’é˜¶æ®µï¼Œå…·ä½“å®ç°éœ€è¦è€ƒè™‘SEæ¡†æ¶çš„å…·ä½“éœ€æ±‚å’Œæ•°æ®æµè½¬è§„èŒƒã€‚


## é…ç½®ç³»ç»Ÿ

### å·¥ä½œç›®å½•è§„èŒƒ
**é¡¹ç›®æ ¹ç›®å½•**: `/home/uaih3k9x/630_swe`  
**SEæ¡†æ¶è¿è¡Œ**: ä»æ ¹ç›®å½•æ‰§è¡ŒSEç›¸å…³å‘½ä»¤  
**SE Iteratorè°ƒç”¨æ ¼å¼**: `python SE/core/swe_iterator.py SE/configs/base_configs/test_claude.yaml`

> **è·¯å¾„çº¦å®š**: æ‰€æœ‰é…ç½®æ–‡ä»¶è·¯å¾„ç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•ç¼–å†™ï¼Œç¡®ä¿ä¸é¡¹ç›®æ•´ä½“æ¶æ„ä¸€è‡´ã€‚

### SEä¸»é…ç½®æ–‡ä»¶ (se_configs/*.yaml)
```yaml
# SEæ¡†æ¶çš„å…¨å±€é…ç½®ï¼Œç”±SE_Runnerä½¿ç”¨
# è¿è¡Œç›®å½•: /home/uaih3k9x/630_swe (æ ¹ç›®å½•)

# ä¸»æ¨¡å‹é…ç½® (SWE-agentä½¿ç”¨ï¼Œéµå¾ªLiteLLMæ ¼å¼)
model:
  name: "anthropic/claude-sonnet-4-20250514"
  api_base: "your_api_base"
  api_key: "your-api-key"
  max_input_tokens: 128000
  max_output_tokens: 64000
  per_instance_cost_limit: 0.01    # SWEå¿…è¦å‚æ•°
  total_cost_limit: 0.1             # SWEå¿…è¦å‚æ•°

# ç®—å­æ¨¡å‹é…ç½® (ç®—å­å¤„ç†æ—¶ä½¿ç”¨ï¼Œå¯é€‰)
operator_models:
  name: "anthropic/claude-sonnet-4-20250514"
  api_base: "your_api_base"
  api_key: "your-api-key"
  max_input_tokens: 128000
  max_output_tokens: 64000
  # æ³¨æ„ï¼šä¸éœ€è¦cost limitå‚æ•°

# å®ä¾‹é…ç½® (ä¸ç°æœ‰æ ¼å¼å®Œå…¨ä¸€è‡´)
instances:
  json_file: "SE/instances/test.json"
  key: "instances"
  subset: "verified"
  split: "test"
  shuffle: false
  evaluate: false

# è¾“å‡ºé…ç½® (é‡è¦å‚æ•°)
output_dir: "SE/trajectories/experiment_001"  # æœ€é‡è¦å‚æ•°ä¹‹ä¸€
suffix: "specific_instances"
num_workers: 14

# ç­–ç•¥ç¼–æ’ï¼šå®šä¹‰å¤šæ¬¡è¿­ä»£çš„æ‰§è¡Œè®¡åˆ’
strategy:
  iterations:
    - base_config: "test_claude"           # ç¬¬1æ¬¡ï¼šåŸºç¡€é…ç½®
      operator: null
    - base_config: "baseconfig1"           # ç¬¬2æ¬¡ï¼šä¸åŒé…ç½®
      operator: null  
    - base_config: "test_claude"           # ç¬¬3æ¬¡ï¼šåŸºç¡€é…ç½®+ç®—å­
      operator: "Crossover"
```

### SWE-agentåŸºç¡€é…ç½® (base_configs/*.yaml)
```yaml
# çº¯å‡€çš„SWE-agenté…ç½®ï¼Œç»™SWE_Iteratorä½¿ç”¨
agent:
  model: 
    name: "anthropic/claude-sonnet-4-20250514"
tools:
  - name: "bash"
  - name: "str_replace_editor"
# ... å…¶ä»–SWE-agentåŸç”Ÿé…ç½®
```

## ç®—å­ç³»ç»Ÿ

ç®—å­æ˜¯**æ•°æ®å¤„ç†æµç¨‹**ï¼ŒåŸºäºç°ä»£åŒ–çš„ç±»æ¶æ„è®¾è®¡ã€‚æ¯ä¸ªç®—å­ï¼š

1. **è¾“å…¥**: å·¥ä½œç›®å½•ä¸‹çš„å†å²æ•°æ®ï¼ˆ.trajè½¨è¿¹æ–‡ä»¶ç­‰ï¼‰
2. **å¤„ç†**: åˆ†æè½¨è¿¹æ•°æ®ï¼Œæå–é—®é¢˜é™ˆè¿°ï¼Œè°ƒç”¨LLMç”Ÿæˆç­–ç•¥
3. **è¾“å‡º**: ç¬¦åˆ`instance_templates_dir`æˆ–`enhance_history_filter_json`æ ¼å¼çš„æ–‡ä»¶/è·¯å¾„
4. **ä¼ é€’**: å°†ç”Ÿæˆçš„è·¯å¾„å‚æ•°ä¼ ç»™SWE_Iterator

### ç®—å­æ¶æ„è®¾è®¡

#### åŸºç¡€æ¶æ„
- **BaseOperator**: æ‰€æœ‰ç®—å­çš„æŠ½è±¡åŸºç±»ï¼Œæä¾›é€šç”¨åŠŸèƒ½
  - LLMæ¨¡å‹ç®¡ç†å’ŒAPIè°ƒç”¨
  - è½¨è¿¹æ•°æ®åŠ è½½å’Œé—®é¢˜é™ˆè¿°æå–  
  - å¹¶å‘å®ä¾‹å¤„ç†æ¡†æ¶
  - æ—¥å¿—è®°å½•å’Œé”™è¯¯å¤„ç†

- **TemplateOperator**: æ¨¡æ¿ç®—å­åŸºç±»
  - ç”Ÿæˆç³»ç»Ÿæç¤ºæ¨¡æ¿ï¼ˆYAMLæ ¼å¼ï¼‰
  - è¿”å›`instance_templates_dir`å‚æ•°
  - æ”¯æŒç­–ç•¥å‰ç¼€è‡ªå®šä¹‰

- **FilterOperator**: è¿‡æ»¤ç®—å­åŸºç±»ï¼ˆè§„åˆ’ä¸­ï¼‰
  - ç”Ÿæˆå†å²è¿‡æ»¤é…ç½®ï¼ˆJSONæ ¼å¼ï¼‰
  - è¿”å›`enhance_history_filter_json`å‚æ•°

#### æ³¨å†Œç®¡ç†ç³»ç»Ÿ
- **åŠ¨æ€æ³¨å†Œ**: é€šè¿‡`register_operator()`æ³¨å†Œç®—å­ç±»
- **è¿è¡Œæ—¶åˆ›å»º**: é€šè¿‡`create_operator()`åˆ›å»ºç®—å­å®ä¾‹
- **ç±»å‹æ£€æŸ¥**: ç¡®ä¿æ‰€æœ‰ç®—å­ç»§æ‰¿è‡ªBaseOperator
- **å…¨å±€æ³¨å†Œè¡¨**: ç»Ÿä¸€ç®¡ç†æ‰€æœ‰å¯ç”¨ç®—å­

### å¼€å‘ä¸­ç®—å­

#### DemoTemplateOperator (æ¼”ç¤ºç®—å­)
- **ç±»å‹**: TemplateOperator
- **åŠŸèƒ½**: æ¼”ç¤ºç®—å­ç³»ç»Ÿçš„åŸºæœ¬åŠŸèƒ½
- **ç­–ç•¥å‰ç¼€**: "DEMO SOLUTION STRATEGY"
- **ç”¨é€”**: å¼€å‘æµ‹è¯•å’ŒåŠŸèƒ½éªŒè¯

### è§„åˆ’ä¸­ç®—å­

#### Crossover (äº¤å‰å¯¹æ¯”ç®—å­)
- **åŠŸèƒ½**: åŸºäºå†å²è½¨è¿¹ç”Ÿæˆå¯¹æ¯”ç­–ç•¥
- **è¾“å‡º**: `instance_templates_dir` è·¯å¾„
- **ç­–ç•¥**: åˆ†æå†å²å°è¯•ï¼Œç”Ÿæˆå·®å¼‚åŒ–çš„ç³»ç»Ÿæç¤º

#### Conclusion (ç»“è®ºæ¨å¯¼ç®—å­)  
- **åŠŸèƒ½**: ä¸“æ³¨äºè§£å†³æ–¹æ¡ˆçš„æ”¶æ•›
- **è¾“å‡º**: `enhance_history_filter_json` è·¯å¾„
- **ç­–ç•¥**: æ™ºèƒ½æŒ‡å¯¼ï¼Œå¸®åŠ©æ”¶æ•›åˆ°æœ€ç»ˆè§£å†³æ–¹æ¡ˆ

#### SummaryBug (é”™è¯¯æ€»ç»“ç®—å­)
- **åŠŸèƒ½**: åŸºäºé”™è¯¯æ¨¡å¼ç”Ÿæˆé¿å…ç­–ç•¥
- **è¾“å‡º**: `instance_templates_dir` è·¯å¾„  
- **ç­–ç•¥**: åˆ†æå†å²é”™è¯¯ï¼Œç”Ÿæˆé”™è¯¯é¿å…æç¤º

### ç®—å­å¼€å‘

#### å¼€å‘æµ‹è¯•
ä½¿ç”¨`operator_dev.py`è¿›è¡Œç®—å­å¼€å‘å’Œæµ‹è¯•ï¼š
```bash
# è¿è¡Œç®—å­å¼€å‘æµ‹è¯•
python SE/operator_dev.py

# æ”¯æŒçš„åŠŸèƒ½ï¼š
# - æ¨¡æ‹Ÿè½¨è¿¹ç¯å¢ƒåˆ›å»º
# - ç®—å­æ³¨å†ŒéªŒè¯
# - åŸºç¡€åŠŸèƒ½æµ‹è¯•
# - é”™è¯¯å¤„ç†éªŒè¯
```

#### åˆ›å»ºæ–°ç®—å­
```python
from SE.operators import TemplateOperator, register_operator
from SE.core.utils import get_problem_description

class MyCustomOperator(TemplateOperator):
    def get_name(self):
        return "my_custom"
    
    def get_strategy_prefix(self):
        return "MY CUSTOM STRATEGY"
    
    def _generate_content(self, instance_info, problem_description, trajectory_data):
        # å®ç°å…·ä½“çš„ç”Ÿæˆé€»è¾‘
        return "ç”Ÿæˆçš„ç­–ç•¥å†…å®¹"

# æ³¨å†Œç®—å­
register_operator("my_custom", MyCustomOperator)
```

## æ•°æ®æµè®¾è®¡

```
SEé…ç½®æ–‡ä»¶ 
    â†“
SE_Runner (è§£æstrategyå­—æ®µ)
    â†“
å¾ªç¯æ¯ä¸ªiteration:
    â†“
ç®—å­å¤„ç† (å¦‚éœ€è¦)
    â†“ è¾“å‡ºå±€éƒ¨å‚æ•°
ä¼ é€’å…¨å±€å‚æ•°+å±€éƒ¨å‚æ•°
    â†“
SWE_Iterator (æ‰§è¡Œå•æ¬¡è¿è¡Œ)
    â†“ è¾“å‡ºåˆ° iteration_{num}/
```

## å®é™…æ‰§è¡ŒåŠŸèƒ½

### basic_run.py å®ç°æ–¹æ¡ˆA

`SE/basic_run.py` å·²å®ç°å®Œæ•´çš„å¤šè¿­ä»£æ‰§è¡ŒåŠŸèƒ½ï¼Œé‡‡ç”¨**æ–¹æ¡ˆA: ç›´æ¥è°ƒç”¨swe_iterator.py**ï¼š

#### æ ¸å¿ƒæœºåˆ¶
1. **ä¸´æ—¶é…ç½®ç”Ÿæˆ**: ä¸ºæ¯æ¬¡è¿­ä»£åŠ¨æ€ç”Ÿæˆä¸´æ—¶YAMLé…ç½®æ–‡ä»¶
2. **subprocessè°ƒç”¨**: é€šè¿‡`subprocess.run()`è°ƒç”¨`SE/core/swe_iterator.py`
3. **è‡ªåŠ¨æ¸…ç†**: æ‰§è¡Œå®Œæˆåè‡ªåŠ¨åˆ é™¤ä¸´æ—¶é…ç½®æ–‡ä»¶

#### ä½¿ç”¨æ–¹å¼
```bash
# æ¼”ç¤ºæ¨¡å¼ï¼ˆæŸ¥çœ‹æµç¨‹ï¼Œä¸æ‰§è¡ŒSWE-agentï¼‰
python SE/basic_run.py --mode demo

# ç›´æ¥æ‰§è¡Œæ¨¡å¼ï¼ˆå®é™…è¿è¡ŒSWE-agentï¼‰
python SE/basic_run.py --mode execute

# æŒ‡å®šé…ç½®æ–‡ä»¶
python SE/basic_run.py --config SE/configs/se_configs/custom.yaml --mode execute
```

#### è¾“å‡ºç»“æ„
æ¯æ¬¡è¿è¡Œç”Ÿæˆå”¯ä¸€æ—¶é—´æˆ³ç›®å½•ï¼Œé‡‡ç”¨æ ‡å‡†çš„å¤šè¿­ä»£ç»“æ„ï¼š
```
SE/trajectories/Demo_Structure/
â”œâ”€â”€ iteration_1/
â”‚   â”œâ”€â”€ preds.json                          # é¢„æµ‹ç»“æœæ±‡æ€»
â”‚   â”œâ”€â”€ run_batch.config.yaml               # è¿è¡Œé…ç½®è®°å½•
â”‚   â”œâ”€â”€ run_batch.log                       # æ‰¹å¤„ç†æ—¥å¿—
â”‚   â”œâ”€â”€ run_batch_exit_statuses.yaml        # é€€å‡ºçŠ¶æ€è®°å½•
â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548/             # å®ä¾‹ç›®å½•
â”‚   â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.config.yaml  # å®ä¾‹é…ç½®
â”‚   â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.debug.log    # è°ƒè¯•æ—¥å¿—
â”‚   â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.info.log     # ä¿¡æ¯æ—¥å¿—
â”‚   â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.pred         # é¢„æµ‹ç»“æœ
â”‚   â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.trace.log    # è·Ÿè¸ªæ—¥å¿—
â”‚   â”‚   â””â”€â”€ sphinx-doc__sphinx-8548.traj         # è½¨è¿¹æ–‡ä»¶
â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8551/             # å…¶ä»–å®ä¾‹...
â”‚   â””â”€â”€ ... (æ›´å¤šå®ä¾‹ç›®å½•)
â”œâ”€â”€ iteration_2/
â”‚   â”œâ”€â”€ preds.json                          # ç¬¬äºŒæ¬¡è¿­ä»£ç»“æœ
â”‚   â”œâ”€â”€ run_batch.config.yaml
â”‚   â”œâ”€â”€ run_batch.log
â”‚   â”œâ”€â”€ run_batch_exit_statuses.yaml
â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548/             # ç›¸åŒå®ä¾‹çš„ç¬¬äºŒæ¬¡å°è¯•
â”‚   â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.config.yaml
â”‚   â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.debug.log
â”‚   â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.info.log
â”‚   â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.pred
â”‚   â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.trace.log
â”‚   â”‚   â””â”€â”€ sphinx-doc__sphinx-8548.traj
â”‚   â””â”€â”€ ... (ç›¸åŒå®ä¾‹çš„ä¸åŒè¿­ä»£)
â””â”€â”€ se_framework.log                        # SEæ¡†æ¶æ€»ä½“æ—¥å¿—
```

#### æ ¸å¿ƒç‰¹æ€§

**ğŸ¯ åŒæ¨¡å¼è¿è¡Œæ”¯æŒ**
- `--mode demo`: æ¼”ç¤ºæ¨¡å¼ï¼Œæ˜¾ç¤ºé…ç½®æµç¨‹ä½†ä¸æ‰§è¡ŒSWE-agent
- `--mode execute`: ç›´æ¥æ‰§è¡Œæ¨¡å¼ï¼Œè‡ªåŠ¨è¿è¡Œæ‰€æœ‰è¿­ä»£

**âš™ï¸ åŠ¨æ€é…ç½®ç®¡ç†**
- **æ—¶é—´æˆ³ç›®å½•**: æ¯æ¬¡è¿è¡Œç”Ÿæˆå”¯ä¸€çš„`test_{timestamp}`ç›®å½•ï¼Œé¿å…å†²çª
- **ä¸´æ—¶é…ç½®ç”Ÿæˆ**: ä¸ºæ¯æ¬¡è¿­ä»£åŠ¨æ€åˆ›å»ºä¸´æ—¶YAMLé…ç½®æ–‡ä»¶
- **å‚æ•°å®æ—¶æ˜¾ç¤º**: æ‰§è¡Œå‰æ˜¾ç¤ºå®é™…ä¼ é€’ç»™SWE-agentçš„æ‰€æœ‰å‚æ•°
- **è‡ªåŠ¨æ¸…ç†**: æ‰§è¡Œå®Œæˆåè‡ªåŠ¨åˆ é™¤ä¸´æ—¶é…ç½®æ–‡ä»¶

**ğŸ”„ ç­–ç•¥é©±åŠ¨çš„å¤šè¿­ä»£æ‰§è¡Œ**
- **é…ç½®é©±åŠ¨**: ä»SEé…ç½®æ–‡ä»¶çš„`strategy.iterations`è¯»å–è¿­ä»£è®¡åˆ’
- **ä¸‰å‚æ•°å˜åŒ–è®¾è®¡**: æ¯æ¬¡è¿­ä»£ä»…æœ‰3ä¸ªå…³é”®å‚æ•°å‘ç”Ÿå˜åŒ–
  - `base_config`: æ¯æ¬¡è¿­ä»£ä½¿ç”¨ä¸åŒçš„SWE-agentåŸºç¡€é…ç½®
  - `operator`: æ¯æ¬¡è¿­ä»£å¯èƒ½ä½¿ç”¨ä¸åŒçš„ç®—å­ç­–ç•¥
  - `output_dir`: æ¯æ¬¡è¿­ä»£ç‹¬ç«‹çš„è¾“å‡ºç›®å½•
- **ç®—å­å‚æ•°æ‰©å±•**: å½“operatoræœ‰è¿”å›å€¼æ—¶ï¼Œä¼šåŠ¨æ€æ·»åŠ é¢å¤–å‚æ•°
  - `instance_templates_dir`: Crossoverç­‰ç®—å­è¿”å›çš„æ¨¡æ¿ç›®å½•è·¯å¾„
  - `enhance_history_filter_json`: Conclusionç­‰ç®—å­è¿”å›çš„JSONæ–‡ä»¶è·¯å¾„
- **å‚æ•°ç»§æ‰¿**: å…¨å±€å‚æ•°ï¼ˆmodelã€instancesã€num_workersç­‰ï¼‰åœ¨è¿­ä»£é—´ä¿æŒä¸€è‡´

**ğŸ“‹ å®Œæ•´çš„æ—¥å¿—å’Œç›‘æ§ç³»ç»Ÿ**
- **SEæ¡†æ¶æ—¥å¿—**: è®°å½•åˆ°`se_framework.log`ï¼ŒåŒ…å«è¯¦ç»†çš„æ‰§è¡Œæµç¨‹
- **SWE-agentè¾“å‡º**: ç»ˆç«¯å®Œæ•´æ˜¾ç¤ºSWE-agentçš„æ€è€ƒå’Œæ‰§è¡Œè¿‡ç¨‹
- **é…ç½®é€æ˜**: æ˜¾ç¤ºä¼ é€’ç»™æ¯æ¬¡è¿­ä»£çš„å®é™…é…ç½®å‚æ•°
- **çŠ¶æ€è¿½è¸ª**: å®æ—¶æ˜¾ç¤ºæ¯æ¬¡è¿­ä»£çš„æˆåŠŸ/å¤±è´¥çŠ¶æ€

**ğŸ›¡ï¸ é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶**
- **å¼‚å¸¸æ•è·**: å®Œå–„çš„å¼‚å¸¸å¤„ç†ï¼Œè®°å½•è¯¦ç»†é”™è¯¯ä¿¡æ¯
- **å¤±è´¥å¤„ç†**: æŸæ¬¡è¿­ä»£å¤±è´¥æ—¶å¯é€‰æ‹©åœæ­¢æˆ–ç»§ç»­
- **èµ„æºæ¸…ç†**: ç¡®ä¿ä¸´æ—¶æ–‡ä»¶å’Œèµ„æºå¾—åˆ°æ­£ç¡®æ¸…ç†
- **æ—¥å¿—è®°å½•**: æ‰€æœ‰é”™è¯¯å’Œå¼‚å¸¸éƒ½è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶

## æ ¸å¿ƒæœ¯è¯­

### è¿è¡Œ (Run)
- **å®šä¹‰**: SEç³»ç»Ÿçš„ä¸€æ¬¡å®Œæ•´æ‰§è¡Œ
- **åŒ…å«**: å¤šä¸ªè¿­ä»£(iterations)çš„å®Œæ•´è¿‡ç¨‹
- **è¾“å‡ºè·¯å¾„**: `SE/trajectories/{å”¯ä¸€ID}/`

### è¿­ä»£ (Iteration)
- **å®šä¹‰**: ä¸€æ¬¡SWE-agentçš„å…·ä½“æ‰§è¡Œ
- **è¡¨ç°**: å®ä¾‹ç›®å½•ä¸‹çš„`iteration_{num}/`æ–‡ä»¶å¤¹ (iteration_1/, iteration_2/, iteration_3/, ...)
- **å†…å®¹**: åŒ…å«`.traj`, `.patch`, `.pred`, `preds.json`ç­‰SWE-agentè¾“å‡ºæ–‡ä»¶

### ç®—å­ (Operator)
- **å®šä¹‰**: æ•°æ®å¤„ç†æµç¨‹ï¼Œä¸æ˜¯å…·ä½“çš„ä»£ç æ–‡ä»¶
- **ç”¨é€”**: åˆ†æå†å²æ•°æ®ï¼Œç”Ÿæˆè¿è¡Œæ—¶å¢å¼ºå‚æ•°
- **ç¤ºä¾‹**: `Crossover`, `Conclusion`, `SummaryBug`

### ç­–ç•¥ç¼–æ’
- **å®šä¹‰**: é€šè¿‡ç®—å­ç»„åˆå®ç°çš„è¿è¡Œç­–ç•¥
- **ç¤ºä¾‹**: `config1+null`, `config2+null`, `config1+Crossover`

## ä½¿ç”¨æ–¹å¼

### å·¥ä½œç›®å½•è®¾ç½®
```bash
# ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œæ‰€æœ‰SEç›¸å…³å‘½ä»¤
cd /home/uaih3k9x/630_swe
```

> **æ³¨æ„**: SEæ¡†æ¶ä¸é¡¹ç›®ä¸­çš„å…¶ä»–æ¡†æ¶ï¼ˆAtlasç­‰ï¼‰å…±äº«åŒä¸€å·¥ä½œç›®å½•çº¦å®šã€‚

### SWE Iteratorè°ƒç”¨æ ¼å¼ (å½“å‰å¯ç”¨)
```bash
# æ ‡å‡†æ ¼å¼ï¼šä½¿ç”¨@ç¬¦å·å¼•ç”¨é…ç½®æ–‡ä»¶
python SE/swe_iterator.py @SE/configs/base_configs/test_claude.yaml

# æˆ–è€…ç›´æ¥è·¯å¾„ (ç›¸å¯¹äºæ ¹ç›®å½•)
python SE/swe_iterator.py SE/configs/test_config/test_claude.yaml
```

### SE_Runnerç”¨æ³• (å¾…å®ç°)
```bash
# ä½¿ç”¨SEä¸»é…ç½®æ‰§è¡Œå®Œæ•´å®éªŒ
python SE/SE_runner.py SE/configs/se_configs/example_experiment.yaml

# ä½¿ç”¨ç‰¹å®šçš„se_config
python SE/SE_runner.py SE/configs/se_configs/test_claude_se.yaml
```

### ç®—å­æµ‹è¯•
```python
# æµ‹è¯•ç®—å­åŠŸèƒ½
from SE.operators import get_operator

op = get_operator("Crossover")
templates_dir, json_file = op.process(workspace_dir, instances)
```

## å®ç°çŠ¶æ€

### âœ… å·²å®Œæˆ
- [x] **ç›®å½•ç»“æ„æ¸…ç†**: åˆ é™¤è¿‡åº¦å¤æ‚çš„æŠ½è±¡å±‚
- [x] **é…ç½®ç³»ç»Ÿé‡ç»„**: se_configs/ å’Œ base_configs/ åˆ†ç¦»
- [x] **ç®—å­ç³»ç»Ÿæ¶æ„**: å®Œæ•´çš„åŸºç±»å’Œæ³¨å†Œç³»ç»Ÿï¼ˆoperators/base.py, registry.pyï¼‰
- [x] **SWE_Iteratorå®ç°**: ç»Ÿä¸€è¿­ä»£è¿è¡Œå™¨ï¼ˆcore/swe_iterator.pyï¼‰
- [x] **SEæ—¥å¿—ç³»ç»Ÿ**: åŸºäºSWE-agentçš„ä¸“ç”¨æ—¥å¿—ç®¡ç†ï¼ˆcore/utils/se_logger.pyï¼‰
- [x] **åŸºç¡€è¿è¡Œå™¨**: å¯ç”¨çš„å¤šè¿­ä»£æ‰§è¡Œç³»ç»Ÿï¼ˆbasic_run.pyï¼‰âœ¨
- [x] **ç®—å­å¼€å‘å·¥å…·**: å¼€å‘æµ‹è¯•è„šæœ¬ï¼ˆoperator_dev.pyï¼‰
- [x] **æ ‡å‡†è¾“å‡ºç»“æ„**: Demo_Structureå±•ç¤ºçš„å¤šè¿­ä»£ç›®å½•ç»„ç»‡
- [x] **å®ä¾‹æµ‹è¯•æ•°æ®**: æµ‹è¯•ç”¨ä¾‹é…ç½®æ–‡ä»¶ï¼ˆinstances/ç›®å½•ï¼‰
- [x] **è½¨è¿¹å¤„ç†ç³»ç»Ÿ**: å®Œæ•´çš„.traæ–‡ä»¶ç”Ÿæˆå’Œtokenå‹ç¼©åŠŸèƒ½ âœ¨
- [x] **Problemæå–åŠŸèƒ½**: è‡ªåŠ¨æå–problemæè¿°ä¸º.problemæ–‡ä»¶ âœ¨
- [x] **å¼€å‘æŒ‡å—æ–‡æ¡£**: Pythonè·¯å¾„é—®é¢˜è§£å†³æ–¹æ¡ˆå’Œæœ€ä½³å®è·µ âœ¨

### ğŸš§ è¿›è¡Œä¸­
- [ ] **å…·ä½“ç®—å­å®ç°**: Crossoverã€Conclusionã€SummaryBugç®—å­
- [ ] **SE_Runner**: å¤–å±‚ç»Ÿä¸€ç®¡ç†å™¨ï¼ˆåŸºäºbasic_run.pyæ‰©å±•ï¼‰
- [ ] **å®Œæ•´å·¥ä½œæµæµ‹è¯•**: ç«¯åˆ°ç«¯åŠŸèƒ½éªŒè¯

### ğŸ“‹ æ¶æ„å®Œæˆåº¦
- **æ ¸å¿ƒæ¶æ„**: âœ… å®Œæˆ - ç®—å­åŸºç±»ã€æ³¨å†Œç³»ç»Ÿã€æ—¥å¿—ç³»ç»Ÿ
- **è¿è¡Œç³»ç»Ÿ**: âœ… å®Œæˆ - è¿­ä»£è¿è¡Œå™¨ã€åŸºç¡€æ‰§è¡Œå™¨ã€è½¨è¿¹å¤„ç†
- **é…ç½®ç®¡ç†**: âœ… å®Œæˆ - å¤šå±‚é…ç½®ç³»ç»Ÿ
- **å¼€å‘å·¥å…·**: âœ… å®Œæˆ - å¼€å‘æµ‹è¯•è„šæœ¬ã€å‘½ä»¤è¡Œå·¥å…·
- **æ•°æ®å¤„ç†**: âœ… å®Œæˆ - .traç”Ÿæˆã€problemæå–ã€tokenç»Ÿè®¡
- **å…·ä½“ç®—å­**: ğŸš§ è¿›è¡Œä¸­ - éœ€è¦å®ç°å…·ä½“çš„ç®—å­é€»è¾‘

## ä¸å…¶ä»–æ¡†æ¶çš„å…³ç³»

SEæ¡†æ¶ä½œä¸ºæ•´ä¸ª 630_swe é¡¹ç›®çš„ä¸€ä¸ªç»„ä»¶ï¼Œä¸å…¶ä»–æ¡†æ¶çš„å…³ç³»å¦‚ä¸‹ï¼š

- **åŸºäºSWE-agent**: ä½¿ç”¨ `sweagent/` ç›®å½•ä¸­çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œé€šè¿‡Hookæœºåˆ¶å®ç°å¹²é¢„
- **ç»§æ‰¿ç»Ÿä¸€è¿è¡Œå™¨**: SWE_IteratoråŸºäºé¡¹ç›®ä¸­å·²æœ‰çš„ç»Ÿä¸€è¿è¡Œå™¨è®¾è®¡æ¨¡å¼
- **ç‹¬ç«‹å®éªŒå±‚**: SEæ¡†æ¶ä¸“æ³¨äºå¤šæ ·æ€§å®éªŒï¼Œä¸ä¿®æ”¹å…¶ä»–æ¡†æ¶çš„åº•å±‚é€»è¾‘
- **æ•°æ®å…¼å®¹**: å¯ä»¥å¤„ç†å’Œåˆ†ææ¥è‡ªå…¶ä»–æ¡†æ¶çš„è½¨è¿¹æ•°æ®

> **æ¶æ„å®šä½**: SEæ¡†æ¶æ˜¯é¡¹ç›®çš„å®éªŒæ‰©å±•å±‚ï¼Œä¸“æ³¨äºå¤šè¿­ä»£ç­–ç•¥è€Œéæ›¿æ¢ç°æœ‰æ¡†æ¶ã€‚

## å¼€å‘åŸåˆ™

1. **ç®€å•æ€§**: é¿å…è¿‡åº¦æŠ½è±¡ï¼Œä¸“æ³¨SEæ¡†æ¶æ ¸å¿ƒåŠŸèƒ½
2. **å¯æ‰©å±•æ€§**: ç®—å­ç³»ç»Ÿæ”¯æŒæ–°ç­–ç•¥çš„è½»æ¾æ·»åŠ 
3. **æ¸…æ™°èŒè´£**: SE_Runnerç®¡ç†å…¨å±€ï¼ŒSWE_Iteratorè´Ÿè´£æ‰§è¡Œï¼Œç®—å­å¤„ç†æ•°æ®
4. **é¡¹ç›®å…¼å®¹**: ä¿æŒä¸æ•´ä¸ª 630_swe é¡¹ç›®ç”Ÿæ€çš„å…¼å®¹æ€§

## é‡è¦æ¾„æ¸…å’Œé£é™©ç‚¹

### æœ¯è¯­æ¾„æ¸…

#### æ ¹ç›®å½•æ¦‚å¿µ
- **æ ¹ç›®å½•**: `/home/uaih3k9x/630_swe` æŒ‡é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰€æœ‰gitæ“ä½œåœ¨æ­¤æ‰§è¡Œ
- **è·¯å¾„ç¼–å†™**: é…ç½®æ–‡ä»¶ä¸­è·¯å¾„å‡ç›¸å¯¹äºæ ¹ç›®å½•ï¼Œä¾¿äºç‰ˆæœ¬æ§åˆ¶å’Œéƒ¨ç½²

#### Operatorè®¾è®¡åŸç†
- **è¾“å…¥**: SWE-agentäº§ç”Ÿçš„è½¨è¿¹æ•°æ®å’Œå†å²æ–‡ä»¶
- **å¤„ç†**: åˆ†æã€ç”Ÿæˆä¸ªæ€§åŒ–ç­–ç•¥ä¿¡æ¯
- **è¾“å‡º**: è¿”å›æ–‡ä»¶å¤¹è·¯å¾„æˆ–JSONæ–‡ä»¶è·¯å¾„ï¼ˆä¸æ˜¯ç›´æ¥çš„å‚æ•°å€¼ï¼‰
- **æ¶ˆè´¹**: SWE_Iteratoræ ¹æ®special_argumentsåœ¨è¿è¡Œæ—¶æŒ‰éœ€è¯»å–è·¯å¾„å†…å®¹


---

*æœ¬æ–‡æ¡£æ—¢æ˜¯SEæ¡†æ¶çš„å¼€å‘æŒ‡å—ï¼Œä¹Ÿæ˜¯åŠŸèƒ½éœ€æ±‚è§„èŒƒï¼Œä¸ºå¼€å‘å’Œä½¿ç”¨æä¾›ç»Ÿä¸€å‚è€ƒã€‚*

## ğŸ”¥ æœ€æ–°æ›´æ–°ï¼ˆ2025-07-14ï¼‰

### ğŸ¯ **è½¨è¿¹å¤„ç†ç³»ç»Ÿå®Œæˆ**

å®ç°äº†å®Œæ•´çš„è½¨è¿¹æ–‡ä»¶å¤„ç†å’Œæ•°æ®æå–åŠŸèƒ½ï¼š

#### **æ ¸å¿ƒåŠŸèƒ½**
- **è‡ªåŠ¨.traæ–‡ä»¶ç”Ÿæˆ**: æ¯æ¬¡iterationåè‡ªåŠ¨å‹ç¼©è½¨è¿¹æ–‡ä»¶
- **æ™ºèƒ½Tokenå‹ç¼©**: å¹³å‡å‹ç¼©ç‡75%-87%ï¼Œå¤§å¹…èŠ‚çœå­˜å‚¨å’Œå¤„ç†æˆæœ¬
- **Problemæè¿°æå–**: è‡ªåŠ¨æå–`<pr_description>`æ ‡ç­¾å†…å®¹ä¸º`.problem`æ–‡ä»¶
- **è¯¦ç»†ç»Ÿè®¡æ—¥å¿—**: è®°å½•åŸå§‹tokenæ•°ã€å‹ç¼©åtokenæ•°ã€èŠ‚çœæ¯”ä¾‹ç­‰è¯¦ç»†ä¿¡æ¯

#### **å‹ç¼©æ•ˆæœç¤ºä¾‹**
```
ğŸ¬ INFO å·²åˆ›å»º sphinx-doc__sphinx-9461.tra: 112 å†å²é¡¹, 6258 tokens 
        (åŸå§‹: 48622, èŠ‚çœ: 42364, å‹ç¼©ç‡: 87.1%)
```

#### **ä½¿ç”¨æ–¹å¼**
```bash
# è‡ªåŠ¨é›†æˆï¼šbasic_run.pyæ‰§è¡Œæ—¶è‡ªåŠ¨ç”Ÿæˆ
python SE/basic_run.py --mode execute

# æ‰‹åŠ¨ç”Ÿæˆï¼šç‹¬ç«‹å·¥å…·
python SE/core/utils/generate_tra_files.py workspace_dir --extract-problems

# åªæå–problemæ–‡ä»¶
python SE/core/utils/generate_tra_files.py workspace_dir --problems-only
```

#### **è¾“å‡ºç»“æ„å¢å¼º**
```
iteration_1/
â”œâ”€â”€ sphinx-doc__sphinx-8548/
â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.traj     # åŸå§‹è½¨è¿¹ï¼ˆå®Œæ•´ï¼‰
â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.tra      # ç®€åŒ–è½¨è¿¹ï¼ˆå‹ç¼©80%+ï¼‰âœ¨
â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.problem  # é—®é¢˜æè¿°ï¼ˆçº¯æ–‡æœ¬ï¼‰âœ¨
â”‚   â”œâ”€â”€ sphinx-doc__sphinx-8548.pred
â”‚   â””â”€â”€ ...å…¶ä»–æ–‡ä»¶
```

### ğŸ› ï¸ **å¼€å‘ä½“éªŒæ”¹è¿›**

#### **Pythonè·¯å¾„é—®é¢˜å½»åº•è§£å†³**
- åˆ›å»ºäº†å®Œæ•´çš„å¼€å‘æŒ‡å—ï¼ˆ`SE/DEVELOPMENT_GUIDE.md`ï¼‰
- æ ‡å‡†åŒ–äº†æ¨¡å—å¯¼å…¥æ¨¡å¼
- å®ç°äº†å»¶è¿Ÿå¯¼å…¥æœºåˆ¶é¿å…å¾ªç¯å¯¼å…¥
- æä¾›äº†è·¯å¾„é—®é¢˜è°ƒè¯•æ–¹æ³•

#### **basic_run.pyå®Œå…¨å¯ç”¨**
- ä¿®å¤äº†æ‰€æœ‰æ¨¡å—å¯¼å…¥é”™è¯¯
- æ”¯æŒæ¼”ç¤ºæ¨¡å¼å’Œæ‰§è¡Œæ¨¡å¼
- è‡ªåŠ¨é›†æˆè½¨è¿¹å¤„ç†åŠŸèƒ½
- å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

### ğŸ“Š **æ•°æ®å¤„ç†èƒ½åŠ›**

#### **Tokenå‹ç¼©æŠ€æœ¯**
- **æ™ºèƒ½æˆªæ–­**: ä¿ç•™å†…å®¹çš„å‰20%å’Œå10%å…³é”®ä¿¡æ¯
- **è§’è‰²åŒºåˆ†**: assistantä¿ç•™thought/actionï¼Œå…¶ä»–è§’è‰²ä¿ç•™content
- **å·¥å…·ä¼˜åŒ–**: å¯¹str_replace_editorç­‰é•¿è¾“å‡ºç‰¹åˆ«ä¼˜åŒ–
- **ç»Ÿè®¡ç²¾ç¡®**: æä¾›è¯¦ç»†çš„å‹ç¼©å‰åå¯¹æ¯”æ•°æ®

#### **é—®é¢˜æè¿°è·å–ç²¾åº¦**
- **ç»Ÿä¸€æ¥å£**: `get_problem_description()` æä¾›æ ‡å‡†åŒ–è·å–æ–¹å¼
- **å¤šæºæ”¯æŒ**: è‡ªåŠ¨é€‰æ‹©.problemæ–‡ä»¶ã€è½¨è¿¹æå–æˆ–JSONé…ç½®çš„æœ€ä½³æ¥æº
- **ä¼˜å…ˆçº§ç®¡ç†**: .problemæ–‡ä»¶ > è½¨è¿¹æå– > JSONé…ç½®
- **éªŒè¯æœºåˆ¶**: `validate_problem_availability()` æ£€æŸ¥æ‰€æœ‰å¯ç”¨è·å–æ–¹æ³•
- **å‡†ç¡®å®šä½**: è‡ªåŠ¨è¯†åˆ«`Trajectory[1]["content"][0]["text"]`ä½ç½®
- **æ ‡ç­¾è§£æ**: ç²¾ç¡®æå–`<pr_description>`æ ‡ç­¾å†…å®¹
- **æ ¼å¼æ¸…ç†**: è¾“å‡ºçº¯å‡€çš„é—®é¢˜æè¿°æ–‡æœ¬
- **æ‰¹é‡å¤„ç†**: æ”¯æŒworkspaceçº§åˆ«çš„æ‰¹é‡æå–

### ğŸ“ **é—®é¢˜æè¿°ç®¡ç†ç³»ç»Ÿ** âœ¨ **NEW**

SEæ¡†æ¶æä¾›äº†ç»Ÿä¸€çš„é—®é¢˜æè¿°è·å–å’Œç®¡ç†æ¥å£ï¼Œè§£å†³äº†å¤šæºæ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼š

#### **ç»Ÿä¸€æ¥å£è®¾è®¡**
```python
from SE.core.utils import get_problem_description, validate_problem_availability

# æ™ºèƒ½è·å– - è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ¥æº
problem = get_problem_description('path/to/instance')

# æŒ‡å®šæ¥æº - ç²¾ç¡®æ§åˆ¶è·å–æ–¹å¼
problem_from_file = get_problem_description('instance_path', method='file')
problem_from_traj = get_problem_description('instance_path', method='trajectory') 
problem_from_json = get_problem_description('instance_path', method='json')

# éªŒè¯å¯ç”¨æ€§ - æ£€æŸ¥æ‰€æœ‰è·å–æ–¹æ³•
validation = validate_problem_availability('instance_path')
```

#### **å¤šæºè·å–ç­–ç•¥**
1. **`.problem`æ–‡ä»¶** (æœ€é«˜ä¼˜å…ˆçº§)
   - çº¯æ–‡æœ¬æ ¼å¼ï¼Œç›´æ¥å¯ç”¨
   - ç”±è½¨è¿¹å¤„ç†ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆ
   - é€‚åˆç®—å­å¿«é€Ÿè¯»å–

2. **è½¨è¿¹æ–‡ä»¶æå–** (ä¸­ç­‰ä¼˜å…ˆçº§)
   - ä»`.traj`æˆ–`.tra`æ–‡ä»¶è§£æ`<pr_description>`æ ‡ç­¾
   - å®æ—¶æå–ï¼Œä¿è¯æ•°æ®æœ€æ–°
   - è‡ªåŠ¨å¤„ç†å¤æ‚çš„JSONç»“æ„

3. **JSONé…ç½®** (å¤‡ç”¨é€‰é¡¹)
   - ä»å®ä¾‹é…ç½®æ–‡ä»¶è·å–
   - æ”¯æŒé™æ€é—®é¢˜æè¿°
   - å¾…å®ç°åŠŸèƒ½

#### **éªŒè¯ç»“æœç¤ºä¾‹**
```json
{
  "instance_name": "sphinx-doc__sphinx-10435",
  "methods_available": ["file", "trajectory"],
  "primary_source": "file",
  "problem_length": 245,
  "problem_preview": "Incorrect result with Quaterniont.to_rotation_matrix()..."
}
```

### ğŸ”§ **å·¥å…·é“¾å®Œå–„**

#### **å‘½ä»¤è¡Œå·¥å…·**
- `generate_tra_files.py`: åŠŸèƒ½å®Œæ•´çš„è½¨è¿¹å¤„ç†å·¥å…·
- æ”¯æŒdry-runæ¨¡å¼é¢„è§ˆ
- æ”¯æŒå•iterationå’Œworkspaceä¸¤ç§å¤„ç†æ¨¡å¼
- æ”¯æŒ.traå’Œ.problemæ–‡ä»¶çš„ç‹¬ç«‹æˆ–è”åˆç”Ÿæˆ

#### **Python API**
```python
from SE.core.utils import TrajectoryProcessor, extract_problems_from_workspace
from SE.core.utils import get_problem_description, validate_problem_availability

# è½¨è¿¹å¤„ç†
processor = TrajectoryProcessor()
stats = processor.process_iteration_directory(Path('iteration_1'))

# é—®é¢˜æè¿°è·å– (ç»Ÿä¸€æ¥å£)
problem = get_problem_description('path/to/instance')  # è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ¥æº
problem = get_problem_description('path/to/instance', method='file')  # ä¼˜å…ˆ.problemæ–‡ä»¶
problem = get_problem_description('path/to/instance', method='trajectory')  # ä»è½¨è¿¹æå–

# é—®é¢˜æè¿°éªŒè¯
validation = validate_problem_availability('path/to/instance')
# è¿”å›: {"methods_available": ["file", "trajectory"], "primary_source": "file", ...}

# é—®é¢˜æè¿°æ‰¹é‡æå–
results = extract_problems_from_workspace('workspace_dir')
```

### ğŸ¤– **LLMé›†æˆè½¨è¿¹åˆ†æç³»ç»Ÿ** âœ¨ **NEW**

SEæ¡†æ¶ç°åœ¨æ”¯æŒæ™ºèƒ½LLMé©±åŠ¨çš„è½¨è¿¹åˆ†æå’Œæ€»ç»“åŠŸèƒ½ï¼š

#### **æ ¸å¿ƒåŠŸèƒ½**
- **æ™ºèƒ½è½¨è¿¹æ€»ç»“**: ä½¿ç”¨LLMæ·±åº¦åˆ†ææ¯æ¬¡è¿­ä»£çš„è§£å†³æ–¹æ¡ˆæ–¹æ³•
- **ç»“æ„åŒ–è¾“å‡º**: æå–å…³é”®ä¿¡æ¯å¦‚ä¿®æ”¹æ–‡ä»¶ã€æŠ€æœ¯ç­–ç•¥ã€æ¨ç†æ¨¡å¼ç­‰
- **è‡ªåŠ¨å¤‡ç”¨æœºåˆ¶**: LLMè°ƒç”¨å¤±è´¥æ—¶è‡ªåŠ¨é™çº§åˆ°åŸºç¡€æ€»ç»“
- **è½¨è¿¹æ± ç®¡ç†**: å¤šè¿­ä»£å®éªŒçš„å®Œæ•´è½¨è¿¹æ•°æ®ç®¡ç†å’Œåˆ†æ

#### **LLMåˆ†æè¾“å‡ºç¤ºä¾‹**
```json
{
  "approach_summary": "ä¿®å¤LaTeXè¾“å‡ºä¸­ä¸éœ€è¦çš„ç©ºç™½ï¼Œé€šè¿‡ä¿®æ”¹LaTeX writerä½¿ç”¨%æ ‡è®°é˜²æ­¢å†…è”ä»£ç å—å‘¨å›´çš„ç©ºæ ¼æ’å…¥",
  "modified_files": ["/testbed/sphinx/writers/latex.py", "/testbed/test_latex_inline_code.py"],
  "key_changes": ["æ·»åŠ %æ ‡è®°åˆ°sphinxcodeç­‰å†…è”ä»£ç åŒ…è£…å™¨", "ä¿®æ”¹LaTeXTranslatorä¸­æ‰€æœ‰ç›¸å…³æ–¹æ³•"],
  "strategy": "1. è¯†åˆ«é—®é¢˜ 2. å®šä½ä»£ç  3. åº”ç”¨LaTeXç©ºç™½æ§åˆ¶ 4. éªŒè¯ä¿®æ”¹",
  "specific_techniques": ["LaTeXç©ºç™½æ§åˆ¶", "æµ‹è¯•é©±åŠ¨éªŒè¯"],
  "reasoning_pattern": "é—®é¢˜è¯†åˆ«â†’ä»£ç è°ƒæŸ¥â†’è§£å†³æ–¹æ¡ˆè®¾è®¡â†’å®ç°éªŒè¯"
}
```

#### **è‡ªåŠ¨é›†æˆ**
- **æ— ç¼é›†æˆ**: SEæ¡†æ¶è‡ªåŠ¨ä½¿ç”¨LLMåˆ†ææ¯æ¬¡è¿­ä»£è½¨è¿¹
- **é…ç½®çµæ´»**: æ”¯æŒoperator_modelsé…ç½®ç‹¬ç«‹äºä¸»æ¨¡å‹
- **æ™ºèƒ½é™çº§**: LLMä¸å¯ç”¨æ—¶è‡ªåŠ¨ä½¿ç”¨åŸºç¡€æ€»ç»“ä¿è¯ç³»ç»Ÿç¨³å®šæ€§

#### **è½¨è¿¹æ± å¢å¼º**
```
trajectories/test_{timestamp}/
â”œâ”€â”€ iteration_1/                    # è¿­ä»£æ‰§è¡Œç»“æœ
â”œâ”€â”€ iteration_2/                    # è¿­ä»£æ‰§è¡Œç»“æœ
â””â”€â”€ traj.pool                       # ğŸ†• æ™ºèƒ½åˆ†æçš„è½¨è¿¹æ€»ç»“æ± 
```

#### **æµ‹è¯•éªŒè¯**
- **é›†æˆæµ‹è¯•**: `test/llm_integration/` ç›®å½•åŒ…å«å®Œæ•´æµ‹è¯•ç”¨ä¾‹
- **çœŸå®æ•°æ®éªŒè¯**: å·²åœ¨å®é™…è½¨è¿¹æ•°æ®ä¸ŠéªŒè¯LLMåˆ†æè´¨é‡
- **æ€§èƒ½ä¼˜åŒ–**: æ™ºèƒ½Tokenç®¡ç†å’ŒAPIè°ƒç”¨ä¼˜åŒ–

### ğŸ“‹ **å¯ç«‹å³ä½¿ç”¨åŠŸèƒ½**

1. **å®Œæ•´çš„å¤šè¿­ä»£SEæ¡†æ¶**: `python SE/basic_run.py --mode execute`
2. **è½¨è¿¹æ•°æ®è‡ªåŠ¨å‹ç¼©**: æ¯æ¬¡iterationè‡ªåŠ¨ç”Ÿæˆ.traæ–‡ä»¶  
3. **ğŸ†• é—®é¢˜æè¿°ç»Ÿä¸€è·å–**: æ ‡å‡†åŒ–çš„é—®é¢˜æè¿°è·å–å’ŒéªŒè¯æ¥å£
4. **ğŸ†• æ™ºèƒ½è½¨è¿¹åˆ†æ**: LLMé©±åŠ¨çš„æ·±åº¦è½¨è¿¹ç†è§£å’Œæ€»ç»“
5. **è¯¦ç»†çš„æ€§èƒ½ç»Ÿè®¡**: å‹ç¼©ç‡ã€tokenèŠ‚çœç­‰å…³é”®æŒ‡æ ‡
6. **å¥å£®çš„é”™è¯¯å¤„ç†**: è§£å†³äº†æ‰€æœ‰å·²çŸ¥çš„Pythonè·¯å¾„é—®é¢˜

### ğŸ¯ **ä¸‹ä¸€æ­¥è®¡åˆ’**

- **å…·ä½“ç®—å­å®ç°**: åŸºäºå®Œå–„çš„.traã€.problemå’ŒLLMåˆ†ææ•°æ®å®ç°Crossoverã€Conclusionç­‰ç®—å­
- **ç®—å­ç”Ÿæ€æ‰©å±•**: åˆ©ç”¨LLMåˆ†æç»“æœå¼€å‘æ›´æ™ºèƒ½çš„ç®—å­ç±»å‹
- **æ€§èƒ½ä¼˜åŒ–**: åŸºäºå‹ç¼©æ•°æ®å’ŒLLMåˆ†æçš„é«˜æ•ˆç®—å­å¤„ç†æµç¨‹
- **å¤šæ¨¡å‹æ”¯æŒ**: æ‰©å±•å¯¹æ›´å¤šLLMæä¾›å•†çš„æ”¯æŒ

## ğŸ“Š **æ ¸å¿ƒæ•°æ®æ ¼å¼è§„èŒƒ**

SEæ¡†æ¶ä¸ºoperatoræä¾›äº†ç»Ÿä¸€çš„æ•°æ®è®¿é—®æ¥å£ï¼Œç¡®ä¿æ•°æ®æµè½¬çš„æ ‡å‡†åŒ–å’Œä¸€è‡´æ€§ã€‚

### **å››ç§æ ¸å¿ƒæ•°æ®æ ¼å¼**

#### **1. Problem Description (é—®é¢˜æè¿°)**
- **å®šä¹‰**: æ¯ä¸ªå®ä¾‹çš„é—®é¢˜é™ˆè¿°ï¼Œæè¿°éœ€è¦è§£å†³çš„å…·ä½“é—®é¢˜
- **æ ¼å¼**: çº¯æ–‡æœ¬å­—ç¬¦ä¸²
- **è·å–æ–¹å¼**: 
  - ä¼˜å…ˆçº§1: `.problem`æ–‡ä»¶ (ç”±è½¨è¿¹å¤„ç†ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆ)
  - ä¼˜å…ˆçº§2: ä»è½¨è¿¹æ–‡ä»¶è§£æ`<pr_description>`æ ‡ç­¾
  - ä¼˜å…ˆçº§3: JSONé…ç½®æ–‡ä»¶ä¸­çš„æè¿°
- **ç”¨é€”**: ä¸ºoperatoræä¾›é—®é¢˜ä¸Šä¸‹æ–‡ï¼Œç”Ÿæˆé’ˆå¯¹æ€§ç­–ç•¥

#### **2. TRAæ–‡ä»¶ (å‹ç¼©è½¨è¿¹)**
- **å®šä¹‰**: ç»è¿‡æ™ºèƒ½å‹ç¼©çš„è½¨è¿¹æ•°æ®ï¼Œä¿ç•™å…³é”®ä¿¡æ¯
- **æ ¼å¼**: JSONæ ¼å¼ï¼ŒåŒ…å«ç®€åŒ–çš„æ‰§è¡Œæ­¥éª¤å’Œç»“æœ
- **ç‰¹ç‚¹**: 
  - å¹³å‡å‹ç¼©ç‡75%-87%
  - ä¿ç•™å…³é”®çš„æ€è€ƒè¿‡ç¨‹å’Œæ‰§è¡ŒåŠ¨ä½œ
  - å»é™¤å†—ä½™çš„ä¸­é—´è¾“å‡º
- **ç”¨é€”**: ä¸ºoperatoræä¾›é«˜æ•ˆçš„å†å²æ‰§è¡Œæ•°æ®åˆ†æ

#### **3. PATCHæ–‡ä»¶ (é¢„æµ‹ç»“æœ)**
- **å®šä¹‰**: å®ä¾‹çš„æœ€ç»ˆé¢„æµ‹ç»“æœï¼Œé€šå¸¸ä¸ºä»£ç ä¿®æ”¹æˆ–è§£å†³æ–¹æ¡ˆ
- **æ ¼å¼**: æ–‡æœ¬æ ¼å¼ï¼Œé€šå¸¸ä¸ºdiffæ ¼å¼æˆ–çº¯æ–‡æœ¬
- **æ–‡ä»¶ä¼˜å…ˆçº§**: `.patch` > `.pred` (é‡è¦æ›´æ–°)
- **ç”¨é€”**: å±•ç¤ºæ¯æ¬¡è¿­ä»£çš„å…·ä½“è¾“å‡ºå’Œè§£å†³æ–¹æ¡ˆ

#### **4. Trajectory Pool (è½¨è¿¹æ± )**
- **å®šä¹‰**: å®ä¾‹åœ¨å¤šä¸ªè¿­ä»£ä¸­çš„æ™ºèƒ½åˆ†ææ€»ç»“æ•°æ®
- **æ ¼å¼**: JSONæ ¼å¼ï¼ŒåŒ…å«LLMåˆ†æçš„ç»“æ„åŒ–æ´å¯Ÿ
- **åŒ…å«ä¿¡æ¯**:
  - é—®é¢˜æè¿°
  - æ¯æ¬¡è¿­ä»£çš„æ–¹æ³•æ€»ç»“
  - ä¿®æ”¹æ–‡ä»¶åˆ—è¡¨
  - æŠ€æœ¯ç­–ç•¥å’Œæ¨ç†æ¨¡å¼
- **ç”¨é€”**: ä¸ºoperatoræä¾›è·¨è¿­ä»£çš„å†å²åˆ†æå’Œè¶‹åŠ¿æ´å¯Ÿ

### **ç»Ÿä¸€æ•°æ®è®¿é—®æ¥å£**

#### **åŸºç¡€ä½¿ç”¨**
```python
from SE.core.utils.instance_data_manager import get_instance_data_manager

# è·å–æ•°æ®ç®¡ç†å™¨
manager = get_instance_data_manager()

# è·å–å•ä¸ªå®ä¾‹çš„å®Œæ•´æ•°æ®
instance_data = manager.get_instance_data(instance_path)

# è®¿é—®å››ç§æ ¸å¿ƒæ•°æ®
problem = instance_data.problem_description  # é—®é¢˜æè¿°
tra_content = instance_data.tra_content      # å‹ç¼©è½¨è¿¹
patch_content = instance_data.patch_content  # é¢„æµ‹ç»“æœ (.patchä¼˜å…ˆ)
traj_content = instance_data.traj_content    # åŸå§‹è½¨è¿¹ (å¯é€‰)
```

#### **è½¨è¿¹æ± è®¿é—®**
```python
# è·å–å®ä¾‹åœ¨è½¨è¿¹æ± ä¸­çš„å®Œæ•´æ•°æ®
pool_data = manager.get_traj_pool_data(traj_pool_path, instance_name)

# è·å–ç‰¹å®šè¿­ä»£çš„æ€»ç»“
iteration_summary = manager.get_instance_iteration_summary(
    traj_pool_path, instance_name, iteration_number
)
```

#### **æ‰¹é‡å¤„ç†**
```python
# è·å–æ•´ä¸ªè¿­ä»£ç›®å½•çš„æ‰€æœ‰å®ä¾‹
instances = manager.get_iteration_instances(iteration_dir)

# æ•°æ®å®Œæ•´æ€§éªŒè¯
for instance in instances:
    completeness = manager.validate_instance_completeness(instance)
    print(f"å®ä¾‹ {instance.instance_name}: {completeness['completeness_score']}% å®Œæ•´")
```

### **Operatorå¼€å‘æ ‡å‡†æ¨¡å¼**

```python
from SE.core.utils.instance_data_manager import get_instance_data_manager

class MyOperator(TemplateOperator):
    def _generate_content(self, instance_info, problem_description, trajectory_data):
        manager = get_instance_data_manager()
        
        # 1. è·å–å½“å‰å®ä¾‹æ•°æ®
        instance_data = manager.get_instance_data(instance_info['path'])
        
        # 2. è®¿é—®æ ‡å‡†åŒ–æ•°æ®
        problem = instance_data.problem_description
        tra_data = instance_data.tra_content
        patch_data = instance_data.patch_content
        
        # 3. è·å–è½¨è¿¹æ± å†å²æ•°æ®
        pool_data = manager.get_traj_pool_data(
            self.traj_pool_path, instance_info['name']
        )
        
        # 4. åˆ†æå’Œç”Ÿæˆç­–ç•¥
        strategy = self.analyze_and_generate_strategy(
            problem, tra_data, patch_data, pool_data
        )
        
        return strategy
```

### **æ•°æ®å®Œæ•´æ€§ä¿è¯**

#### **ä¼˜å…ˆçº§è¯»å–æœºåˆ¶**
- **PATCHæ–‡ä»¶**: `.patch` â†’ `.pred` (è‡ªåŠ¨é€‰æ‹©æœ€ä½³)
- **é—®é¢˜æè¿°**: `.problem` â†’ è½¨è¿¹æå– â†’ JSONé…ç½®
- **è½¨è¿¹æ•°æ®**: `.tra` â†’ `.traj` (å‹ç¼©ä¼˜å…ˆ)

#### **éªŒè¯å’Œè°ƒè¯•**
```python
# éªŒè¯å®ä¾‹æ•°æ®å®Œæ•´æ€§
validation = manager.validate_instance_completeness(instance_data)
print(f"å®Œæ•´æ€§: {validation['completeness_score']}%")
print(f"ç¼ºå¤±æ•°æ®: {validation['missing_data']}")

# æ£€æŸ¥å¯ç”¨æ–‡ä»¶
print(f"å¯ç”¨æ–‡ä»¶: {instance_data.available_files}")
```

### **å‘åå…¼å®¹æ€§**

SEæ¡†æ¶ä¿æŒä¸ç°æœ‰ä»£ç çš„å…¼å®¹æ€§ï¼ŒåŒæ—¶æä¾›æ–°çš„æ ‡å‡†åŒ–æ¥å£ï¼š

```python
# æ—§å¼æ¥å£ (ä»ç„¶æ”¯æŒ)
from SE.core.utils.traj_extractor import TrajExtractor
extractor = TrajExtractor()
legacy_data = extractor.extract_instance_data(iteration_dir)

# æ–°å¼æ¥å£ (æ¨è)
structured_data = extractor.extract_instances_structured(iteration_dir)
```

### **æœ€ä½³å®è·µ**

1. **æ€»æ˜¯ä½¿ç”¨ç»Ÿä¸€æ¥å£**: é€šè¿‡`InstanceDataManager`è®¿é—®æ•°æ®
2. **éªŒè¯æ•°æ®å®Œæ•´æ€§**: ä½¿ç”¨`validate_instance_completeness()`æ£€æŸ¥
3. **å¤„ç†ç¼ºå¤±æ•°æ®**: ä¼˜é›…å¤„ç†`None`å€¼å’Œä¸å®Œæ•´æ•°æ®
4. **åˆ©ç”¨è½¨è¿¹æ± **: å……åˆ†åˆ©ç”¨è·¨è¿­ä»£çš„å†å²åˆ†ææ•°æ®
5. **éµå¾ªä¼˜å…ˆçº§**: ä¿¡ä»»ç³»ç»Ÿçš„æ–‡ä»¶ä¼˜å…ˆçº§é€‰æ‹©æœºåˆ¶

è¿™å¥—æ•°æ®æ ¼å¼è§„èŒƒç¡®ä¿äº†SEæ¡†æ¶ä¸­operatorçš„æ•°æ®è®¿é—®ä¸€è‡´æ€§ï¼Œä¸ºæ‰©å±•å’Œç»´æŠ¤æä¾›äº†åšå®çš„åŸºç¡€ã€‚